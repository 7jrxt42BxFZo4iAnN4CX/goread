<!DOCTYPE html>
<html lang="en" ng-app>
<head>
	<link href="{{.BootstrapCss}}" rel="stylesheet">
	<style>
		[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
			display: none;
		}
	</style>
</head>
<body ng-controller="GoreadCtrl">
	<div class="navbar navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="{{ url "main" }}">go read</a>
			<ul class="nav">
			</ul>
			<ul class="nav pull-right">
				<li class="dropdown">
				{{if .User}}
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">
						{{.User}}
						<b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li><a href="{{url "import-reader"}}">import google reader</a></li>
						<li><a href="#" ng-click="shown = 'add-subscription'">add subscription</a></li>
						<li><a href="#" ng-click="shown = 'import-opml'">import opml</a></li>
						<li><a id="refresh" href="#" ng-click="refresh()" data-url="{{url "list-feeds"}}">refresh</a></li>
						<li class="divider"></li>
						<li><a href="{{ url "logout" }}">logout</a></li>
					</ul>
				{{else}}
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">
						log in / sign up
						<b class="caret"></b>
					</a>
					<ul class="dropdown-menu">
						<li><a href="{{ url "login-google" }}">with google</a></li>
					</ul>
				{{end}}
				</li>
			</ul>
		</div>
	</div>
	<div class="container" class="ng-cloak">
		<div class="row">
		{{if .User}}
			<div class="span6">
				<h3>Feeds:</h3>
				<ul>
					<li ng-repeat="f in feeds" ng-bind="f.Url"></li>
				</ul>
			</div>
		{{end}}

			<div class="span6" ng-show="shown == 'import-opml'">
				<form id="import-opml-form" enctype="multipart/form-data" method="POST" action="{{ url "import-opml" }}">
					<fieldset>
						<label>Reader OPML file:
							<input type="file" name="file">
						<label>
						<button ng-click="importOpml()" type="submit" class="btn">import</button>
					</fieldset>
				</form>
			</div>

			<div class="span6" ng-show="shown == 'add-subscription'">
				<form id="add-subscription-form" method="POST" action="{{ url "add-subscription" }}">
					<fieldset>
						<label>RSS URL
							<input type="text" name="url">
						</label>
						<button ng-click="addSubscription()" type="submit" class="btn">add</button>
					</fieldset>
				</form>
			</div>
		</div>
	</div>

	<script src="{{.Jquery}}"></script>
	<script src="{{.BootstrapJs}}"></script>
	<script src="/static/js/site.js"></script>
	<script src="/static/js/jquery.form.js"></script>
	<script src="{{.Angular}}"></script>

	{{.MiniProfiler}}
</body>
</html>
